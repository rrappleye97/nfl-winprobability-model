<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A The First Appendix | Modeling Win Probability in NFL Games</title>
  <meta name="description" content="A The First Appendix | Modeling Win Probability in NFL Games">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="A The First Appendix | Modeling Win Probability in NFL Games" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A The First Appendix | Modeling Win Probability in NFL Games" />
  
  
  

<meta name="author" content="Robert Rappleye">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="5-discussion.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="literature-review.html"><a href="literature-review.html"><i class="fa fa-check"></i>Literature Review</a></li>
<li class="chapter" data-level="1" data-path="1-data.html"><a href="1-data.html"><i class="fa fa-check"></i><b>1</b> Data</a></li>
<li class="chapter" data-level="2" data-path="2-methodology.html"><a href="2-methodology.html"><i class="fa fa-check"></i><b>2</b> Methodology</a><ul>
<li class="chapter" data-level="2.1" data-path="2-methodology.html"><a href="2-methodology.html#modeling-win-probability-on-kickoffs-and-point-after-attempts"><i class="fa fa-check"></i><b>2.1</b> Modeling Win Probability on Kickoffs and Point After Attempts</a></li>
<li class="chapter" data-level="2.2" data-path="2-methodology.html"><a href="2-methodology.html#modeling-win-probability-on-first-and-ten"><i class="fa fa-check"></i><b>2.2</b> Modeling Win Probability on First and Ten</a></li>
<li class="chapter" data-level="2.3" data-path="2-methodology.html"><a href="2-methodology.html#modeling-win-probability-in-other-scenarios"><i class="fa fa-check"></i><b>2.3</b> Modeling Win Probability in Other Scenarios</a></li>
<li class="chapter" data-level="2.4" data-path="2-methodology.html"><a href="2-methodology.html#reasoning-behind-modeling-methodology"><i class="fa fa-check"></i><b>2.4</b> Reasoning Behind Modeling Methodology</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-results.html"><a href="3-results.html"><i class="fa fa-check"></i><b>3</b> Results</a></li>
<li class="chapter" data-level="4" data-path="4-applications.html"><a href="4-applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a></li>
<li class="chapter" data-level="5" data-path="5-discussion.html"><a href="5-discussion.html"><i class="fa fa-check"></i><b>5</b> Discussion</a><ul>
<li class="chapter" data-level="5.1" data-path="5-discussion.html"><a href="5-discussion.html#conclusion"><i class="fa fa-check"></i><b>5.1</b> Conclusion</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html"><i class="fa fa-check"></i><b>A</b> The First Appendix</a><ul>
<li class="chapter" data-level="A.1" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html#point-chart"><i class="fa fa-check"></i><b>A.1</b> 2 point chart</a></li>
<li class="chapter" data-level="A.2" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html#clock-stop-gbm-to-predict-p_stop_g_k"><i class="fa fa-check"></i><b>A.2</b> Clock Stop GBM to Predict <span class="math inline">\(p_{stop_{G_k}}\)</span></a></li>
<li class="chapter" data-level="A.3" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html#downs-outcome-formulas"><i class="fa fa-check"></i><b>A.3</b> Downs outcome formulas</a></li>
<li class="chapter" data-level="A.4" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html#gbm-for-p_penaltyreplay"><i class="fa fa-check"></i><b>A.4</b> GBM for <span class="math inline">\(P_{penaltyReplay}\)</span></a></li>
<li class="chapter" data-level="A.5" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html#gbms-for-p_score"><i class="fa fa-check"></i><b>A.5</b> GBMs for <span class="math inline">\(P_{score}\)</span></a></li>
<li class="chapter" data-level="A.6" data-path="A-the-first-appendix.html"><a href="A-the-first-appendix.html#linear-models-for-delta-field-position-outcome_g_k"><i class="fa fa-check"></i><b>A.6</b> Linear Models for <span class="math inline">\(\Delta field position | outcome_{g_k}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modeling Win Probability in NFL Games</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-first-appendix" class="section level1">
<h1><span class="header-section-number">A</span> The First Appendix</h1>
<div id="point-chart" class="section level2">
<h2><span class="header-section-number">A.1</span> 2 point chart</h2>
<p>The (very) naive two point decision making models assumes that teams go for two when the score differential is one of the following during the period between the touchdown and point after attempt:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">-</th>
<th align="left">-</th>
<th align="left">-</th>
<th align="left">-</th>
<th align="left">-</th>
<th align="left">-</th>
<th align="left">-</th>
<th align="center">-</th>
<th align="center">-</th>
<th align="center">-</th>
<th align="center">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Two Point Conversion Score Differentials</td>
<td align="left">19</td>
<td align="left">12</td>
<td align="left">5</td>
<td align="left">4</td>
<td align="left">1</td>
<td align="left">-2</td>
<td align="left">-9</td>
<td align="center">-10</td>
<td align="center">-16</td>
<td align="center">-17</td>
<td align="center">-18</td>
</tr>
</tbody>
</table>
</div>
<div id="clock-stop-gbm-to-predict-p_stop_g_k" class="section level2">
<h2><span class="header-section-number">A.2</span> Clock Stop GBM to Predict <span class="math inline">\(p_{stop_{G_k}}\)</span></h2>
<p>This GBM predicts the probability of the clock stopped on a given play by using the following variables where the value for each variable is the value for the variable at the previous kickoff to account for that face that this model has to predict the probability of the clock stopping not just for the current play but also for some number of plays in the future despite being unable to update other information.</p>
<table>
<caption>(#tab:clockstop GBM)Variables used in GBM that predicts P(Clock Stoppage)</caption>
<thead>
<tr class="header">
<th align="left">Variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Clock Will Stop</td>
</tr>
<tr class="even">
<td align="left">Number of Plays Until the Next Scoring Event</td>
</tr>
<tr class="odd">
<td align="left">Timeout Adjusted Time Remaining in the Half</td>
</tr>
<tr class="even">
<td align="left">The Comeback Score</td>
</tr>
</tbody>
</table>
</div>
<div id="downs-outcome-formulas" class="section level2">
<h2><span class="header-section-number">A.3</span> Downs outcome formulas</h2>
<p>When <span class="math inline">\(t_i &gt; 300\)</span> &amp; !<span class="math inline">\((1800 &lt; t_i &lt;= 1980)\)</span> a multinomial logistic regression model is fit, mimicking the process used to predict the next scoring event. The log odds <span class="math inline">\(\delta_ix\)</span> for a given outcome <span class="math inline">\(x\)</span> as compared to the baseline outcome are modeled by:</p>
<p><span class="math inline">\(\delta_ix = \beta_{xint} +\beta_{xpos_{o}}pos_{o_i} + \beta_{xde\hspace{-0.1em}f_{o}}de\hspace{-0.1em}f_{d_i} +\beta_{xpos_{{qb}}}pos_{{qb}_i} + \beta_{xydstogo}ydstogo_i + \beta_{xyrd_{group}}yrd_{group_{i}}\)</span></p>
<p>Each GBM uses the following variables as well as a shrinkage parameter <span class="math inline">\(l = 0.02\)</span>, an interaction depth of two, and 1000 trees. The data on which they are trained is the only difference between the GBMs.</p>
<table>
<caption>(#tab:downs gbms)Variables used in GBM that predicts P(Clock Stoppage)</caption>
<thead>
<tr class="header">
<th align="left">Variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Offensive DVOA for the Team with the Ball</td>
</tr>
<tr class="even">
<td align="left">Defensive DVOA for the Team on Defense</td>
</tr>
<tr class="odd">
<td align="left">Projected QB Grade for the Offensive Team</td>
</tr>
<tr class="even">
<td align="left">Yards to go for a First Down</td>
</tr>
<tr class="odd">
<td align="left">Score Differential</td>
</tr>
<tr class="even">
<td align="left">Timeout Adjusted Time Remaining in the Half</td>
</tr>
<tr class="odd">
<td align="left">Yards from the End Zone Bucketed in Ten Yard Increments</td>
</tr>
</tbody>
</table>
</div>
<div id="gbm-for-p_penaltyreplay" class="section level2">
<h2><span class="header-section-number">A.4</span> GBM for <span class="math inline">\(P_{penaltyReplay}\)</span></h2>
<p>To output the probability of a penalty on a given play the GBM takes in the current down, the outcome of the set of downs and the field position of the offensive team. The shrinkage is given by <span class="math inline">\(l = 0.005\)</span>, the interaction depth is two and the number of trees is 1000.</p>
</div>
<div id="gbms-for-p_score" class="section level2">
<h2><span class="header-section-number">A.5</span> GBMs for <span class="math inline">\(P_{score}\)</span></h2>
<p>The GBM that predicts <span class="math inline">\(P_{TD}\:| \:Conversion\)</span> also uses a shrinkage parameter <span class="math inline">\(l = 0.02\)</span>, an interaction depth of two, and 1000 trees. It is fit with the following variables:</p>
<table>
<caption><span id="tab:off-td-gbm">Table A.1: </span>Variables used in GBM that predicts P(Clock Stoppage)</caption>
<thead>
<tr class="header">
<th align="left">Variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Offensive DVOA for the Team with the Ball</td>
</tr>
<tr class="even">
<td align="left">Defensive DVOA for the Team on Defense</td>
</tr>
<tr class="odd">
<td align="left">Projected QB Grade for the Offensive Team</td>
</tr>
<tr class="even">
<td align="left">Yards to go for a First Down</td>
</tr>
<tr class="odd">
<td align="left">Down</td>
</tr>
<tr class="even">
<td align="left">Yards from the End Zone</td>
</tr>
</tbody>
</table>
<p>The GBM that predicts <span class="math inline">\(P_{defTD}\:|\:Turnover\)</span> utilizes a shrinkage parameter <span class="math inline">\(l = 0.02\)</span>, an interaction depth of two and 1000 trees. It is fitted with only three variables—the square root of yards from the end zone for the team punting, the offensive DVOA for the team on offense and the defensive DVOA for the team on defense.</p>
<p>The GBM that predicts <span class="math inline">\(P_{defTD}\:|\:Punt\)</span> utilizes a shrinkage parameter <span class="math inline">\(l = 0.005\)</span>, an interaction depth of two and 1000 trees. It is fitted with only three variables—the yards from the end zone for the team punting and the special teams DVOAs for both teams.</p>
<p>The GBM that predicts <span class="math inline">\(P_{Make}\:|\:FG Attempt\)</span> depends only on the square root of yards from the end zone for the team kicking the field goal, as does the GBM that predicts the <span class="math inline">\(P_{defTD}\:|\:FG Block\)</span>. Both have <span class="math inline">\(l = 0.01\)</span> and <span class="math inline">\(ntrees = 1000\)</span>, though the field goal make GBM uses an interaction depth of one while the field goal block GBM uses an interaction depth of two.</p>
</div>
<div id="linear-models-for-delta-field-position-outcome_g_k" class="section level2">
<h2><span class="header-section-number">A.6</span> Linear Models for <span class="math inline">\(\Delta field position | outcome_{g_k}\)</span></h2>
<p><strong>Conversion</strong>
For first and second down all models for change in field position for conversions have the same formula. A given model <span class="math inline">\(m\)</span> has formula as follows. A reminder that <span class="math inline">\(yrds\)</span> is the field position of the offensive team:
<span class="math inline">\(y_{mi} = \beta_{mint} + \beta_{m1}*ydstogo_i + \beta_{m2}*\sqrt(yrds_i) + \beta_{m3}*pos_{o_i} + \beta_{m4}*def_{d_i} + \epsilon_{mi}\)</span></p>
<p>For third downs the model has formula:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*\sqrt(yrds_i) + \beta_{3}*pos_{qb_i} + \epsilon_i\)</span></p>
<p>and on fourth downs the model has formula:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*\sqrt(yrds_i) + \beta_{3}*pos_{o_i} + \epsilon_i\)</span></p>
<p><strong>Conversion by Penalty</strong><br />
The model that handles first through third down has form:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*\sqrt(yrds_i) + \beta_{3}*down_i + \beta_{4}*down_i*ydstogo_i + \epsilon_i\)</span></p>
<p>The model for fourth downs is:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*\sqrt(yrds_i) + \epsilon_i\)</span></p>
<p><strong>Turnover on Downs</strong><br />
The model for first through third down looks like:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*\sqrt(yrds_i) + \beta_{3}*pos_{qb_i} + \beta_{4}*t_{adjH} + \beta_{5}*t_{adjH}\sqrt(yrds_i) + \epsilon_i\)</span></p>
<p>The model for fourth downs is much simpler:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \epsilon_i\)</span></p>
<p><strong>Punt</strong><br />
The model for first through third down is:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*\sqrt(yrds_i) + \beta_{3}*pos_{st_i} + \beta_{4}*def_{st_i} + \epsilon_i\)</span></p>
<p>The fourth down model is:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*\sqrt(yrds_i) + \beta_{2}*pos_{st_i} + \beta_{3}*def_{st_i} + \epsilon_i\)</span></p>
<p><strong>Turnover</strong><br />
Though the field position change for turnovers is also modeled with separate models for fourth down and first through third down, the model formula is the same for both models (though coefficients are different). For a given model <span class="math inline">\(m\)</span>:</p>
<p><span class="math inline">\(y_{mi} = \beta_{int} + \beta_{m1}*ydstogo_i + \beta_{m2}*\sqrt(yrds_i) + \beta_{m3}*pos_{qb_i} + \epsilon_{mi}\)</span></p>
<p><strong>Field Goal</strong><br />
The model for change in field position on missed field goals given the current down not being fourth is:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*def_{d_i} + \beta_{3}*down_i + \beta_{4}*ydstogo_i*down_i + \epsilon_{i}\)</span></p>
<p>For blocked field goals the model for change in field position on downs one through three is:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*ydstogo_i + \beta_{2}*def_{d_i} + \beta_{3}*\sqrt(yrds_i) + \epsilon_{i}\)</span></p>
<p>On fourth down the model is:<br />
<span class="math inline">\(y_{i} = \beta_{int} + \beta_{1}*\sqrt(yrds_i) + \epsilon_{i}\)</span></p>

<!--
The bib chunk below must go last in this document according to how R Markdown renders.  More info is at http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
-->

<!-- 
If you'd like to change the name of the bibliography to something else,
delete "References" and replace it.
-->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5-discussion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
